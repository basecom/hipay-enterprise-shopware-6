ARG DOCKWARE_VERSION

FROM dockware/dev:$DOCKWARE_VERSION

LABEL maintainer="PI-Ecommerce"
LABEL maintainer_email="pi-ecommerce@hipay.com"

RUN echo '\
    CAPTURE_MODE=$CAPTURE_MODE \n\
    HIPAY_ENVIRONMENT=$HIPAY_ENVIRONMENT \n\
    OPERATION_MODE=$OPERATION_MODE \n\
    PRIVATE_LOGIN_PRODUCTION=$PRIVATE_LOGIN_PRODUCTION \n\
    PRIVATE_PASSWORD_PRODUCTION=$PRIVATE_PASSWORD_PRODUCTION \n\
    PUBLIC_LOGIN_PRODUCTION=$PUBLIC_LOGIN_PRODUCTION \n\
    PUBLIC_PASSWORD_PRODUCTION=$PUBLIC_PASSWORD_PRODUCTION \n\
    PASSPHRASE_PRODUCTION=$PASSPHRASE_PRODUCTION \n\
    HASH_PRODUCTION=$HASH_PRODUCTION \n\
    PRIVATE_LOGIN_STAGE=$PRIVATE_LOGIN_STAGE \n\
    PRIVATE_PASSWORD_STAGE=$PRIVATE_PASSWORD_STAGE \n\
    PUBLIC_LOGIN_STAGE=$PUBLIC_LOGIN_STAGE \n\
    PUBLIC_PASSWORD_STAGE=$PUBLIC_PASSWORD_STAGE \n\
    PASSPHRASE_STAGE=$PASSPHRASE_STAGE \n\
    HASH_STAGE=$HASH_STAGE \n\
    PRIVATE_APPLEPAY_LOGIN_PRODUCTION=$PRIVATE_APPLEPAY_LOGIN_PRODUCTION \n\
    PRIVATE_APPLEPAY_PASSWORD_PRODUCTION=$PRIVATE_APPLEPAY_PASSWORD_PRODUCTION \n\
    PUBLIC_APPLEPAY_LOGIN_PRODUCTION=$PUBLIC_APPLEPAY_LOGIN_PRODUCTION \n\
    PUBLIC_APPLEPAY_PASSWORD_PRODUCTION=$PUBLIC_APPLEPAY_PASSWORD_PRODUCTION \n\
    APPLEPAY_PASSPHRASE_PRODUCTION=$APPLEPAY_PASSPHRASE_PRODUCTION \n\
    HASH_PRODUCTION_APPLEPAY=$HASH_PRODUCTION_APPLEPAY \n\
    PRIVATE_APPLEPAY_LOGIN_STAGE=$PRIVATE_APPLEPAY_LOGIN_STAGE \n\
    PRIVATE_APPLEPAY_PASSWORD_STAGE=$PRIVATE_APPLEPAY_PASSWORD_STAGE \n\
    PUBLIC_APPLEPAY_LOGIN_STAGE=$PUBLIC_APPLEPAY_LOGIN_STAGE \n\
    PUBLIC_APPLEPAY_PASSWORD_STAGE=$PUBLIC_APPLEPAY_PASSWORD_STAGE \n\
    APPLEPAY_PASSPHRASE_STAGE=$APPLEPAY_PASSPHRASE_STAGE \n\
    HASH_STAGE_APPLEPAY=$HASH_STAGE_APPLEPAY \n\
    LOG_DEBUG=$LOG_DEBUG \
    ' >>.env

COPY . /var/www/html/custom/plugins/HiPayPaymentPlugin/

ADD --chown=root:root bin/docker/images/shopware/entrypoint.sh /post-entrypoint.sh
RUN sudo chmod a+x /post-entrypoint.sh

CMD [ "/post-entrypoint.sh" ]
