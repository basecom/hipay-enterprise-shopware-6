"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["hi-pay-payment-plugin"],{642:(e,t,s)=>{var i,n,r,a=s(6285);class o extends a.Z{init(){if(this.constructor===o)throw new TypeError('Class "HipayHostedFieldsPlugin" cannot be instantiated directly');this.options={...this.getPaymentDefaultOption(),...this.options},this._configHostedFields=this.getConfigHostedFields(),this._form=document.querySelector("#"+this.options.idResponse).form,this._cardInstance=new HiPay(this.options).create(this.getPaymentName(),this._configHostedFields),this._registerEvents()}_registerEvents(){this._cardInstance.on("ready",(()=>{this._cardInstance.on("inputChange",this._inputErrorHandler.bind(this)),this._cardInstance.on("blur",this._inputErrorHandler.bind(this));const e=document.querySelector("#"+this.options.idResponse);let t=!1;this._cardInstance.on("change",(s=>{t=s.valid,t?this._cardInstance.getPaymentData().then((t=>{e.setAttribute("value",JSON.stringify(t))})):e.setAttribute("value","")})),e.addEventListener("invalid",(s=>{t||this._cardInstance.getPaymentData().then((()=>{}),(t=>{e.setAttribute("value",""),t.forEach((e=>this._errorHandler(e.field,!0,e.error)))}))})),this._form.addEventListener("submit",(t=>{t.preventDefault();const s=t.currentTarget;this._cardInstance.getPaymentData().then((t=>{e.setAttribute("value",JSON.stringify(t)),s.submit()}))}))}))}_inputErrorHandler(e){this._errorHandler(e.element,!e.validity.valid,e.validity.error)}_errorHandler(e,t=!1,s=""){const i=this._configHostedFields.fields[e].selector,n=document.querySelector("#"+i);t?n.classList.add(this.options.errorClass):n.classList.remove(this.options.errorClass);const r=document.querySelector(`#${this.options.errorPrefix}-${i}`);r&&(r.innerHTML=s)}getPaymentName(){throw new Error('Method "getPaymentName" must be implemented')}getConfigHostedFields(){throw new Error('Method "getConfigHostedFields" must be implemented')}}i=o,r={username:null,password:null,environment:null,lang:null,idResponse:"hipay-response",cvcHelp:!1,errorClass:"is-invalid",errorPrefix:"error",styles:null},(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n="options"))in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r;var l=s(7906),d=s(8254);class u extends a.Z{init(){this._client=new d.Z,this._registerEvents()}_registerEvents(){this.el.querySelectorAll(".delete-card").forEach((e=>{e.addEventListener("click",(t=>this.onDeleteButtonClick(e)))}))}onDeleteButtonClick(e){const t=e.querySelector("span"),s=new l.Z(e),i=t.style.display;t.style.display="none",s.create(),this._client.delete(`/account/creditcard/${e.dataset.id}`,"",(n=>{try{if(!(n=JSON.parse(n)).success)throw new Error;e.closest(".hipay-token-label").remove()}catch(e){t.style.display=i,s.remove()}}))}}const c=window.PluginManager;c.register("HandlerHipayCreditcardPlugin",class extends o{init(){var e;super.init();const t=document.querySelector(`#${this.options.idResponse}`),s=this._cardInstance;null===(e=document.querySelector("#hipay-multiuse"))||void 0===e||e.addEventListener("change",(function(e){s.setMultiUse(e.target.checked)})),document.querySelectorAll('input[name="hipay-token"]').forEach((e=>e.addEventListener("change",(function(e){var i="",n="block";e.target.getAttribute("value")&&(n="none",i={token:e.target.value,device_fingerprint:s.sdkInstance.getDeviceFingerprint(),browser_info:s.sdkInstance.getBrowserInfo(),payment_product:e.target.dataset.brand}),t.setAttribute("value",JSON.stringify(i)),document.querySelector("#hipay-new-creditcard-block").style.display=n}))))}getPaymentDefaultOption(){return{idCardHolder:"hipay-card-holder",idCardNumber:"hipay-card-number",idExpiryDate:"hipay-expiry-date",idCvc:"hipay-cvc",firstnameValue:"",lastnameValue:""}}getPaymentName(){return"card"}getConfigHostedFields(){const e={fields:{cardHolder:{selector:this.options.idCardHolder,defaultFirstname:this.options.firstnameValue,defaultLastname:this.options.lastnameValue},cardNumber:{selector:this.options.idCardNumber},expiryDate:{selector:this.options.idExpiryDate},cvc:{selector:this.options.idCvc,helpButton:this.options.cvcHelp}}};return this.options.styles&&(e.styles=this.options.styles),e}},"[handler-hipay-creditcard-plugin]"),c.register("HandlerHipayGiropayPlugin",class extends o{getPaymentDefaultOption(){return{idIssuerBank:"hipay-giropay-issuer-bank"}}getPaymentName(){return"giropay"}getConfigHostedFields(){const e={fields:{issuer_bank_id:{selector:this.options.idIssuerBank}}};return this.options.styles&&(e.styles=this.options.styles),e}},"[handler-hipay-giropay-plugin]"),c.register("HandlerHipayIdealPlugin",class extends o{getPaymentDefaultOption(){return{idIssuerBank:"hipay-ideal-issuer-bank"}}getPaymentName(){return"ideal"}getConfigHostedFields(){const e={fields:{issuer_bank_id:{selector:this.options.idIssuerBank}}};return this.options.styles&&(e.styles=this.options.styles),e}},"[handler-hipay-ideal-plugin]"),c.register("HandlerHipayMbwayPlugin",class extends o{getPaymentDefaultOption(){return{phone:"hipay-mbway-phone"}}getPaymentName(){return"mbway"}getConfigHostedFields(){const e={fields:{phone:{selector:this.options.phone}}};return this.options.styles&&(e.styles=this.options.styles),e}},"[handler-hipay-mbway-plugin]"),c.register("HandlerHipaySepadirectdebitPlugin",class extends o{getPaymentDefaultOption(){return{firstname:"hipay-sdd-firstname",lastname:"hipay-sdd-lastname",iban:"hipay-sdd-iban",gender:"hipay-sdd-gender",bank_name:"hipay-sdd-bank-name",genderValue:"U",firstnameValue:"",lastnameValue:""}}getPaymentName(){return"sdd"}getConfigHostedFields(){const e={fields:{firstname:{selector:this.options.firstname,defaultValue:this.options.firstnameValue},lastname:{selector:this.options.lastname,defaultValue:this.options.lastnameValue},iban:{selector:this.options.iban},gender:{selector:this.options.gender,defaultValue:this.options.genderValue},bank_name:{selector:this.options.bank_name}}};return this.options.styles&&(e.styles=this.options.styles),e}},"[handler-hipay-sepadirectdebit-plugin]"),c.register("HipayManageCreditCardPlugin",u,"[hipay-manage-creditcard-plugin]")}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=642,e(e.s=t);var t}));e.O()}]);