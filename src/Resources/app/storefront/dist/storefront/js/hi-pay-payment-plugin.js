"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["hi-pay-payment-plugin"],{5968:(e,t,n)=>{var s,r,i,a=n(6285);class o extends a.Z{init(){if(this.constructor===o)throw new TypeError('Class "HipayHostedFieldsPlugin" cannot be instantiated directly');this.options={...this.getPaymentDefaultOption(),...this.options},this._configHostedFields=this.getConfigHostedFields(),this._form=document.querySelector("#"+this.options.idResponse).form,this._cardInstance=new HiPay(this.options).create(this.getPaymentName(),this._configHostedFields),this._registerEvents()}_registerEvents(){this._cardInstance.on("ready",(()=>{this._cardInstance.on("inputChange",this._inputErrorHandler.bind(this)),this._cardInstance.on("blur",this._inputErrorHandler.bind(this));const e=document.querySelector("#"+this.options.idResponse);let t=!1;this._cardInstance.on("change",(n=>{t=n.valid,t?this._cardInstance.getPaymentData().then((t=>{e.setAttribute("value",JSON.stringify(t))})):e.setAttribute("value","")})),e.addEventListener("invalid",(n=>{t||this._cardInstance.getPaymentData().then((()=>{}),(t=>{e.setAttribute("value",""),t.forEach((e=>this._errorHandler(e.field,!0,e.error)))}))})),this._form.addEventListener("submit",(t=>{t.preventDefault();const n=t.currentTarget;this._cardInstance.getPaymentData().then((t=>{e.setAttribute("value",JSON.stringify(t)),n.submit()}))}))}))}_inputErrorHandler(e){this._errorHandler(e.element,!e.validity.valid,e.validity.error)}_errorHandler(e,t=!1,n=""){const s=this._configHostedFields.fields[e].selector,r=document.querySelector("#"+s);t?r.classList.add(this.options.errorClass):r.classList.remove(this.options.errorClass);const i=document.querySelector(`#${this.options.errorPrefix}-${s}`);i&&(i.innerHTML=n)}getPaymentName(){throw new Error('Method "getPaymentName" must be implemented')}getConfigHostedFields(){throw new Error('Method "getConfigHostedFields" must be implemented')}}s=o,i={username:null,password:null,environment:null,lang:null,idResponse:"hipay-response",cvcHelp:!1,errorClass:"is-invalid",errorPrefix:"error",styles:null},(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(r="options"))in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i;class l extends a.Z{init(){const e={api_apple_pay_username:this.options.username,api_apple_pay_password:this.options.password,merchantId:this.options.merchantId,environment:this.options.environment,lang:this.options.lang,countryCode:this.options.countryCode,currency:this.options.currency,buttonType:this.options.styles.buttonType,buttonStyle:this.options.styles.buttonStyle,totalAmount:this.options.amount.toString(),shopName:this.options.shopname};document.querySelector("#tos").checked=!1;let t=document.querySelector("#confirmFormSubmit");t&&t.remove(),this._form=document.querySelector("#"+this.options.idResponse).form,document.querySelector("#apple-pay-button").style.display="none",this._hfInstance=this.createHostedFieldsInstance(e),this.canMakeApplePayPayment(e.merchantId).then((t=>{t?(document.querySelector("#apple-pay-info-message").style.display="none",document.querySelector("#apple-pay-error-message").style.display="inline",document.querySelector("#apple-pay-error-message").textContent=document.querySelector("#apple-pay-termes-of-service-error-message").textContent,this._applePayInstance=this.createApplePayInstance(e),this.handleTermsOfService(),this.handleApplePayEvents()):(document.querySelector("#apple-pay-info-message").style.display="",document.querySelector("#apple-pay-error-message").style.display="none")}))}handleApplePayEvents(){this._applePayInstance.on("paymentAuthorized",(e=>{let t={payment_product:e.brand,token:e.token,brand:e.brand,"card_expiry-month":e.cardExpiryMonth,"card_expiry-year":e.cardExpiryYear,card_holder:e.cardHolder,pan:e.cardPan,issuer:e.cardIssuer,country:e.cardCountry};document.querySelector("#hipay-response").setAttribute("value",JSON.stringify(t)),this._form.submit(),this._applePayInstance.completePaymentWithSuccess()})),this._applePayInstance.on("paymentUnauthorized",(function(){this.completePaymentWithFailure()}))}handleTermsOfService(){this.checkTermeOfService(),document.querySelector("input[name=tos]").addEventListener("change",(()=>{this.checkTermeOfService()}))}checkTermeOfService(){let e=document.querySelector("#tos"),t=document.querySelector("#apple-pay-button"),n=document.querySelector("#apple-pay-error-message"),s=document.querySelector("#apple-pay-termes-of-service-error-message");!e||e.checked?(t.style.display="",n.style.display="none"):(t.style.display="none",n.style.display="inline",n.textContent=s.textContent)}canMakeApplePayPayment(e){return new Promise((t=>{e?this._hfInstance.canMakePaymentsWithActiveCard(e).then((e=>{t(e)})):t(window.ApplePaySession&&window.ApplePaySession.canMakePayments())}))}createHostedFieldsInstance(e){return new HiPay({username:e.api_apple_pay_username,password:e.api_apple_pay_password,environment:e.environment,lang:e.language_iso_code})}createApplePayInstance(e){const t={label:"Total",amount:e.totalAmount},n={countryCode:e.countryCode,currencyCode:e.currency,total:t,supportedNetworks:["visa","masterCard"]},s={type:e.buttonType,color:e.buttonStyle},r={displayName:e.shopName,request:n,applePayStyle:s,selector:"apple-pay-button"};return this._hfInstance.create("paymentRequestButton",r)}}!function(e,t,n){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(l,"options",{username:null,password:null,environment:null,lang:null,idResponse:"hipay-response",cvcHelp:!1,errorClass:"is-invalid",errorPrefix:"error",styles:null,merchantId:null});class p extends a.Z{init(){let e=document.querySelector("#confirmFormSubmit");e&&e.remove(),this._hipayInstance=new HiPay({username:this.options.username,password:this.options.password,environment:this.options.environment,lang:this.options.lang});const t={template:"auto",selector:"paypal-field",canPayLater:this.options.canPayLater,paypalButtonStyle:{shape:this.options.styles.shape,height:Number(this.options.styles.height),color:this.options.styles.color,label:this.options.styles.label},request:{amount:this.options.amount,currency:this.options.currency,locale:this.options.locale}};this._form=document.querySelector("#"+this.options.idResponse).form,this._paypalInstance=this._hipayInstance.create("paypal",t),this._paypalInstance.on("paymentAuthorized",function(e){document.querySelector("#"+this.options.idResponse).setAttribute("value",JSON.stringify(e)),this._form.submit()}.bind(this))}}!function(e,t,n){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(p,"options",{username:null,password:null,environment:null,canPayLater:null,amount:null,currency:null,lang:null,styles:null,idResponse:"hipay-response"});class u extends o{getPaymentDefaultOption(){return{}}getPaymentName(){return this.options.paymentProductName}getConfigHostedFields(){const e={template:"auto",selector:"default-selector"};return this.options.styles&&(e.styles=this.options.styles),e}}!function(e,t,n){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(u,"options",{username:null,password:null,environment:null,lang:null,styles:null,idResponse:"hipay-response"});var c=n(7906),d=n(8254);class y extends a.Z{init(){this._client=new d.Z,this._registerEvents()}_registerEvents(){this.el.querySelectorAll(".delete-card").forEach((e=>{e.addEventListener("click",(t=>this.onDeleteButtonClick(e)))}))}onDeleteButtonClick(e){const t=e.querySelector("span"),n=new c.Z(e),s=t.style.display;t.style.display="none",n.create(),this._client.delete(`/account/creditcard/${e.dataset.id}`,"",(r=>{try{if(!(r=JSON.parse(r)).success)throw new Error;e.closest(".hipay-token-label").remove()}catch(e){t.style.display=s,n.remove()}}))}}const h=window.PluginManager;h.register("HandlerHipayApplePayPlugin",l,"[handler-hipay-apple-pay-plugin]"),h.register("HandlerHipayPaypalPlugin",p,"[handler-hipay-paypal-plugin]"),h.register("HandlerHipayCreditcardPlugin",class extends o{init(){var e;super.init();const t=document.querySelector(`#${this.options.idResponse}`),n=this._cardInstance;null===(e=document.querySelector("#hipay-multiuse"))||void 0===e||e.addEventListener("change",(function(e){n.setMultiUse(e.target.checked)})),document.querySelectorAll('input[name="hipay-token"]').forEach((e=>e.addEventListener("change",(function(e){var s="",r="block";e.target.getAttribute("value")&&(r="none",s={token:e.target.value,device_fingerprint:n.sdkInstance.getDeviceFingerprint(),browser_info:n.sdkInstance.getBrowserInfo(),payment_product:e.target.dataset.brand}),t.setAttribute("value",JSON.stringify(s)),document.querySelector("#hipay-new-creditcard-block").style.display=r}))))}getPaymentDefaultOption(){return{idCardHolder:"hipay-card-holder",idCardNumber:"hipay-card-number",idExpiryDate:"hipay-expiry-date",idCvc:"hipay-cvc",firstnameValue:"",lastnameValue:""}}getPaymentName(){return"card"}getConfigHostedFields(){const e={fields:{cardHolder:{selector:this.options.idCardHolder,defaultFirstname:this.options.firstnameValue,defaultLastname:this.options.lastnameValue},cardNumber:{selector:this.options.idCardNumber},expiryDate:{selector:this.options.idExpiryDate},cvc:{selector:this.options.idCvc,helpButton:this.options.cvcHelp}}};return this.options.styles&&(e.styles=this.options.styles),e}},"[handler-hipay-creditcard-plugin]"),h.register("HandlerHipayGiropayPlugin",class extends o{getPaymentDefaultOption(){return{idIssuerBank:"hipay-giropay-issuer-bank"}}getPaymentName(){return"giropay"}getConfigHostedFields(){const e={fields:{issuer_bank_id:{selector:this.options.idIssuerBank}}};return this.options.styles&&(e.styles=this.options.styles),e}},"[handler-hipay-giropay-plugin]"),h.register("HandlerHipayIdealPlugin",class extends o{getPaymentDefaultOption(){return{idIssuerBank:"hipay-ideal-issuer-bank"}}getPaymentName(){return"ideal"}getConfigHostedFields(){const e={fields:{issuer_bank_id:{selector:this.options.idIssuerBank}}};return this.options.styles&&(e.styles=this.options.styles),e}},"[handler-hipay-ideal-plugin]"),h.register("HandlerHipayMbwayPlugin",class extends o{getPaymentDefaultOption(){return{phone:"hipay-mbway-phone"}}getPaymentName(){return"mbway"}getConfigHostedFields(){const e={fields:{phone:{selector:this.options.phone}}};return this.options.styles&&(e.styles=this.options.styles),e}},"[handler-hipay-mbway-plugin]"),h.register("HandlerHipaySepadirectdebitPlugin",class extends o{getPaymentDefaultOption(){return{firstname:"hipay-sdd-firstname",lastname:"hipay-sdd-lastname",iban:"hipay-sdd-iban",gender:"hipay-sdd-gender",bank_name:"hipay-sdd-bank-name",genderValue:"U",firstnameValue:"",lastnameValue:""}}getPaymentName(){return"sdd"}getConfigHostedFields(){const e={fields:{firstname:{selector:this.options.firstname,defaultValue:this.options.firstnameValue},lastname:{selector:this.options.lastname,defaultValue:this.options.lastnameValue},iban:{selector:this.options.iban},gender:{selector:this.options.gender,defaultValue:this.options.genderValue},bank_name:{selector:this.options.bank_name}}};return this.options.styles&&(e.styles=this.options.styles),e}},"[handler-hipay-sepadirectdebit-plugin]"),h.register("HandlerHipayDefaultPlugin",u,"[handler-hipay-default-plugin]"),h.register("HipayManageCreditCardPlugin",y,"[hipay-manage-creditcard-plugin]")}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=5968,e(e.s=t);var t}));e.O()}]);